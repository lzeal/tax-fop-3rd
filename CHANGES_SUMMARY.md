# Зміни: Додано звіт ЄСВ F0133109

## Створені файли

### Утиліти
- ✅ `src/utils/esvSettings.ts` - робота з налаштуваннями ЄСВ
- ✅ `src/utils/esvXmlGenerator.ts` - генерація XML звіту F0133109

### Шаблони
- ✅ `src/templates/esvPreviewTemplate.ts` - HTML preview шаблон

### Компоненти
- ✅ `src/components/ESVSettingsModal.tsx` - модальне вікно налаштувань
- ✅ `src/components/ESVReportPreview.tsx` - preview компонент

### Документація
- ✅ `ESV_REPORT_README.md` - повна документація функціоналу

## Змінені файли

### Типи
- ✅ `src/types/index.ts`:
  - Додано `MonthESVSettings`
  - Додано `ESVSettings`
  - Додано `ESVReportData`
  - Додано `TaxReportF0133109`

### UI сторінки
- ✅ `src/pages/ReportsPage.tsx`:
  - Додано імпорти для ЄСВ функціоналу
  - Додано state для ЄСВ модалів
  - Додано функцію `handleGenerateESVReport()`
  - Додано секцію звіту ЄСВ (показується для 4 кварталу)
  - Додано діалоги для налаштувань та preview

- ✅ `src/pages/ConfigPage.tsx`:
  - Додано імпорт `ESVSettingsModal`
  - Додано state для ЄСВ налаштувань
  - Додано секцію швидкого доступу до налаштувань ЄСВ
  - Додано модальне вікно налаштувань

## Функціонал

### Налаштування ЄСВ
- По замовчуванню: 8000 грн/міс, 22%
- Можливість налаштувати для кожного місяця окремо
- Функція "Застосувати далі" для поширення значень
- Зберігання в localStorage

### Генерація звіту
- Звіт доступний тільки для 4 кварталу (річний)
- Попередній перегляд звіту
- Генерація XML згідно зі схемою F0133109.xsd
- Валідація перед генерацією

### Поля звіту
- Місячні дані: R091G2-R0912G2 (сума доходу)
- Місячні дані: R091G3-R0912G3 (відсоток ЄСВ)
- Місячні дані: R091G4-R0912G4 (сума ЄСВ)
- Підсумки: R09G2 (загальний дохід), R09G4 (загальна сума ЄСВ)

## Як користуватися

1. **Налаштування**: 
   - Сторінка "Налаштування" → секція "Налаштування ЄСВ"
   - Або сторінка "Звіти" (4 квартал) → кнопка "Налаштування ЄСВ"

2. **Генерація**:
   - Сторінка "Звіти" → Виберіть 4 квартал
   - Кнопка "Переглянути звіт ЄСВ" для preview
   - Кнопка "Згенерувати F0133109 XML" для завантаження

## Технічні деталі

- Використовується XSD схема `src/templates/F0133109.xsd`
- Дані зберігаються в localStorage з ключем `fop-esv-settings`
- Примітивний preview template (можна редагувати потім)
- Підтримка кількох років
- Автоматичний розрахунок сум ЄСВ
